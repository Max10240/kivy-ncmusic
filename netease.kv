#:import C kivy.utils.get_color_from_hex
#:import SwapTransition kivy.uix.screenmanager.FadeTransition
#:set common app.theme[app.system_config['theme']]['common']
#:set gray (.99,.99,.99)
#:set dark_gray (.9,.9,.9)
#:set white (1,1,1)
#:set black (0,0,0)
#:set hex_light_black '#a0a0a0'

<Widget>:
    font_name: 'kai'
    
<WhiteGridLayout@GridLayout>:
    canvas.before:
        Color:
            rgb: white
        Rectangle:
            pos: self.pos
            size: self.size

<RedGridLayout@GridLayout>:
    canvas.before:
        Color:
            rgb:common
        Rectangle:
            pos: self.pos
            size: self.size

<RedFloatLayout@FloatLayout>:
    canvas.before:
        Color:
            rgb:common
        Rectangle:
            pos: self.pos
            size: self.size
<ScrollView>:
    scroll_timeout: 30000
    scroll_distance: 1
    effect_cls: app.S
    size_hint: (1,1)
    do_scroll_x: False
    on_scroll_start: app.touch_scrllview(args, touch_on=True)
    on_scroll_stop: app.touch_scrllview(args, touch_on=False)
    
    canvas.before:
        Color:
            rgb: white
        Rectangle:
            pos: self.pos
            size: self.size
            
<LeftLabel@Label>:
    color: C('#101010')
    font_size: app.font_size
    text_size: (self.width, None)
    size_hint: (1, None)
    height: self.texture_size[1]
    halign: 'left'
    valign: 'middle'
##    markup: True
    
<FixedHeightLeftLabel@Label>:
    color: C('#101010')
    text_size: (None, self.height)
    size_hint: (None, 1)
    width: self.texture_size[0]
    halign: 'left'
    valign: 'middle'
##    markup: True
    
<MiddleLabel@Label>:
    color: C('#101010')
    font_size: app.font_size

<TextInput>:
    texture_size: self.size
    font_size: app.font_size
    multiline: False
    padding: [10, 0.5 * (self.height - self.line_height)]
    text_language: 'zh_CN'

<ToolGLayout@GridLayout>:
    t0: '?'
    i0: 'src/favorite.png'
    c0: ()
    cols: 1
    GridLayout:
        rows: 1
        LeftLabel:
            size_hint_x: None
            width: root.width*.02

        GridLayout:
            cols: 1
            size_hint_x: None
            width: self.height
            canvas.before:
                Color:
                    rgb: self.parent.parent.c0 or common

                Rectangle:
                    size: self.size
                    pos: self.pos
                    source: self.parent.parent.i0

        FixedHeightLeftLabel:
            text: self.parent.parent.t0

##        LeftLabel:
##            size_hint_x: 9

    GridLayout:
        rows: 1
        size_hint_y: .015
        canvas.before:
            Color:
                rgb: dark_gray
            RoundedRectangle:
                size: self.size
                pos: self.pos


<PlaylistGlayout@GridLayout>:
    size_hint_y: None
    height: app.height*.1
    on_touch_up: app.touch_on_layout(args)
    idd: 'music_list'
    rows: 1

    playlist_id: None
    t0: '1'
    t1: '0首 by Lua'
    i0: 'src/logo.jpg'
    
    Image:
        size_hint_x: None
        width: self.height
        source: self.parent.i0

    GridLayout:
        cols: 1
        FixedHeightLeftLabel:
            size_hint_y: 2
            font_size: min(app.font_size,self.height*.7)
            text: self.parent.parent.t0

        FixedHeightLeftLabel:
            size_hint_y: 1
            font_size: min(app.font_size*.7,self.height)
            text: self.parent.parent.t1
            
    GridLayout:
        rows: 1
        size_hint_x: 8

    Image:
        idd: 'point'
        size_hint_x: .8
        source: 'src/point.png'


<PlaylistManager@GridLayout>:
    t0: 'S(0)'
    on_touch_up: app.touch_on_layout(args)
    rows: 1
    size_hint_y: None
    height: app.height*.04
    
    canvas.before:
        Color:
            rgb: dark_gray
        Rectangle:
            size: self.size
            pos: self.pos

    GridLayout:
        rows: 1
        GridLayout:
            rows: 1
            Image:
                size_hint_x: None
                width: self.height*1.5
                source: 'src/down.png'
                
            FixedHeightLeftLabel:
                text: self.parent.parent.parent.t0

        GridLayout:
            size_hint_x: 4

        Image:
            pos: self.parent.pos[0]+self.parent.width*.88, self.pos[1]
            source: 'src/setting.png'

<SingleMusicGlayout@GridLayout>:
    rows: 1
    size_hint_y: None
    height: app.height*.08
    idd: 'song'
    on_touch_up: app.touch_on_layout(args)
    max_len: 23
    d_info: {}
    n0: '1'
    t0: '还没有缓存音乐哦'
    t1: 'Yourself'
    
    MiddleLabel:
        text: self.parent.n0

    GridLayout:
        cols: 1
        FixedHeightLeftLabel:
            size_hint_y:2
            text: self.parent.parent.t0

        FixedHeightLeftLabel:
            color: C(hex_light_black)
            text: self.parent.parent.t1
    Label:
        size_hint_x: 2

    Image:
        source: 'src/point.png'


<RecommendPlaylist@WhiteGridLayout>:
    cols: 1
    size_hint_y: None
    height: self.minimum_height
    idd: 'music_list'
    on_touch_up: app.touch_on_layout(args)
    
    s0: '1'
    t0: '1'
    playlist_id: '0000'
    
    Image:
        size_hint_y: None
        height: app.width/3
        source: self.parent.s0

    Label:
        color: C('#000000')
        size_hint_y: None
        height:self.font_size*2
        font_size: app.font_size*.7
        text: self.parent.t0

<SideBarBox@GridLayout>:
    idd: ''
    i0: ''
    t0: ''
    on_touch_up: app.touch_on_layout(args)
    rows: 1
    size_hint_y: None
    height: app.height/15
    
    Image:
        size_hint_x: None
        width: self.height
        source: self.parent.i0

    FixedHeightLeftLabel:
        size_hint_x: None
        width: self.font_size*len(self.text)
        text: self.parent.t0
        
ScreenManager:
    transition: SwapTransition(duration=.1)
    Screen:
        name: 'home'

        GridLayout:
            cols: 1
            RedGridLayout:
                cols: 1
                size_hint_y: .4
                id:common_box
                
                RedGridLayout:
                    cols: 1
                    size_hint_y: .3 if not app.is_android else 0
                    
                RedGridLayout:
                    rows: 1
                    id:common_0
                    size_hint_y: 1.5
                    Image:
                        source: 'src/menu.png'
                        idd: 'menu'
                        on_touch_up: app.touch_on_layout(args)
                        
                    Label:
                        
                    Image:
                        source: 'src/music.png'
                        idd: 'music'
                        on_touch_up: app.touch_on_layout(args)
                        
                    Image:
                        source: 'src/wyy.png'
                        idd: 'wyy'
                        on_touch_up: app.touch_on_layout(args)
                        
                    Image:
                        source: 'src/video.png'
                        idd: 'video'
                        on_touch_up: app.touch_on_layout(args)

                    Label:
                    
                    Image:
                        idd: 'search'
                        source: 'src/search.png'
                        on_touch_up: app.touch_on_layout(args)

            GridLayout:
                size_hint_y:5
                id: first_scroll
                cols: 1

                RedGridLayout:
                    id: red_space
                    cols: 1
                    size_hint: None,None
                    width: root.width
                    height: root.height*.01
                    
                GridLayout:
                    id: first_scroll_glayout
                    rows: 1
                    size_hint: None,None
                    size: self.parent.size[0], self.parent.size[1]-red_space.height
                    
                    ScrollView:
                        id: first_page_s
                        size_hint_x: None
                        width: root.width
                        
                        GridLayout:
                            id: first_page_s_g
                            cols: 1
                            size_hint: None,None
                            width: root.width
                            height: self.minimum_height

                            
                            GridLayout:
                                id: user_info_box
                                rows: 1
                                size_hint: 1,None
                                height: root.height*.10
                                c0: ()
                                
                                canvas.before:
                                    Color:
                                        rgb: self.c0 or common
                                    Rectangle:
                                        size: self.width,self.height*.5
                                        pos: self.pos[0], self.center[1] 
                                        
                                    Color:
                                        rgb: gray
                                    RoundedRectangle:
                                        radius: [self.height*.2]
                                        size: self.size[0]*.98,self.size[1]*.95
                                        pos: self.width*.01,self.pos[1]+self.height*.025

                                    Color:
                                        rgb: dark_gray
                                    Rectangle:
                                        size: self.size[0]*.98,self.size[1]*.05
                                        pos: self.width*.01,self.pos[1]+self.height*.025

                                Label:
                                    size_hint_x: None
                                    width: root.width*.03
                                    
                                GridLayout:
                                    id: avatar_image_1
                                    rows: 1
                                    size_hint_x: None
                                    width: self.height
                                    canvas.before:
                                        Ellipse:
                                            source: app.avatar_fn
                                            size: self.height*.90,self.height*.90
                                            pos: self.pos[0], self.pos[1]+root.height*.005

                                Label:
                                    size_hint_x: None
                                    width: root.width*.07
                                    
                                FixedHeightLeftLabel:
                                    id: avatar_text_1
                                    text: app.nickname
                                    

                                Label:

                                GridLayout:
                                    cols: 1
                                    id: vip_round
                                    c0: ()
                                    size_hint_x: None
                                    width: app.font_size*5
                                    
                                    canvas.before:
                                        Color:
                                            rgb: self.c0 or common
                                        Line:
                                            width: 1.01
                                            rounded_rectangle: (self.center[0]-app.font_size*2.5,self.center[1]-app.font_size*.6,app.font_size*5,app.font_size*1.2,app.font_size*.6,app.font_size*.6,app.font_size*.6,app.font_size*.6,100)
                                        
                                    Label:
                                        id: vip
                                        color: common+(1,)
                                        font_size: app.font_size
                                        size_hint: (1, None)
                                        height: self.parent.height
                                        halign: 'center'
                                        valign: 'top'
                                        text: '开通会员'

                                Label:
                                    size_hint_x: .03
                                    
                            GridLayout:
                                id: func_box
                                cols: 1
                                size_hint_y: None
                                height: root.height*.4
                                
                                ToolGLayout:
                                    idd: 'local_music'
                                    on_touch_up: app.touch_on_layout(args)
                                    i0: 'src/local_music.png'
                                    t0: '本地音乐'

                                ToolGLayout:
                                    i0: 'src/nearly_play.png'
                                    t0: '最近播放'
                                 
                                ToolGLayout:
                                    i0: 'src/download_manager.png'
                                    t0: '下载管理'

                                ToolGLayout:
                                    i0: 'src/my_fm.png'
                                    t0: '我的电台'
                                 
                                ToolGLayout:
                                    i0: 'src/favorite.png'
                                    t0: '我的收藏'

                                ToolGLayout:
                                    i0: 'src/sati.png'
                                    t0: 'Sati空间'

                            PlaylistManager:
                                id: created_m_l_m
                                idd: 'created_m_l_m'
                                t0: '创建的歌单(0)'

                            GridLayout:
                                id: created
                                size_hint_y: None
                                height: self.minimum_height
                                cols: 1
                                
                            PlaylistManager:
                                id: collected_m_l_m
                                idd: 'collected_m_l_m'
                                t0: '收藏的歌单(0)'

                            GridLayout:
                                id: collected
                                size_hint_y: None
                                height: self.minimum_height
                                cols: 1

                                PlaylistGlayout:
                                    height:0

                    GridLayout:
                        id: second_page_glayout
                        cols: 1
                        size_hint: None,1
                        width: root.width
                        
                        RedGridLayout:
                            rows: 1
                            id: box_rec_mark
                            size_hint: None,None
                            height: root.height*.05
                            width: root.width
                            
                            Label:
                                text: '推荐'
                                id: recommand
                                idd: 'recommand'
                                on_touch_up: app.touch_on_layout(args)

                            Label:
                                text: '朋友'
                                id: friend
                                idd: 'friend'
                                on_touch_up: app.touch_on_layout(args)
                                

                            Label:
                                text: '电台'
                                id: radio
                                idd: 'radio'
                                on_touch_up: app.touch_on_layout(args)
                            
                        RedFloatLayout:
                            size_hint: None,None
                            height: 5
                            width: root.width
                            id: white_under_line
                            Label:
                                pos_hint: {'center_x': 1/6, 'center_y': 2}
                                id: w_u_l
                                valign: 'top'
                                text: '----'

                            
                        GridLayout:
                            id: scroll_glayout
                            cols: 3
                            size_hint: None,1
                            width: root.width*3
                            height: self.minimum_height
                            
                            ScrollView:
                                id: first_page_2_s
                                size_hint_x: None
                                width: root.width
                                do_scroll_x: False
                                
                                GridLayout:
                                    id: first_page_2
                                    cols: 1
                                    size_hint: None,None
                                    width: root.width
                                    height: self.minimum_height
                                    
                                    GridLayout:
                                        cols: 1
                                        size_hint: 1,None
                                        c0: ()
                                        height: root.width*.33
                                        id: space_red
                                        
                                        canvas.before:
                                            Color:
                                                rgb: self.c0 or common
                                            Rectangle:
                                                size: self.width,self.height*.7
                                                pos: self.pos[0], self.pos[1]+self.height*.3

                                        LeftLabel:
                                            size_hint_y: .05
                                            
                                        GridLayout:
                                            id: img_show
                                            rows: 1
                                            scaling_ratio: .95
                                            canvas.before:
                                                RoundedRectangle:
                                                    size: self.size[0]*self.scaling_ratio, self.size[1]*self.scaling_ratio
                                                    pos: self.pos[0]+self.width*(1-self.scaling_ratio)/2, self.pos[1]+self.height*(1-self.scaling_ratio)/2
                                                    source: 'src/preflash.jpg'

                                    Label:
                                        size_hint_y: None
                                        height: root.height*.02

                                    GridLayout:
                                        cols: 1
                                        size_hint_y: None
                                        height: root.height*.1
                                        id: box_pic_fm
                                        c0: common
                                        canvas.before:
                                            Color:
                                                rgb: self.c0 or common
                                                
                                            Ellipse:
                                                pos: self.pos[0]+self.width/8-self.height*.8/2, self.pos[1]
                                                size: (self.height*.8, self.height*.8)
                                            Ellipse:
                                                pos: self.pos[0]+self.width/8-self.height*.8/2+ self.width/4, self.pos[1]
                                                size: (self.height*.8,self.height*.8)
                                            Ellipse:
                                                pos: self.pos[0]+self.width/8-self.height*.8/2+ self.width/2, self.pos[1]
                                                size: (self.height*.8,self.height*.8)
                                            Ellipse:
                                                pos: self.pos[0]+self.width/8-self.height*.8/2+ self.width/4*3, self.pos[1]
                                                size: (self.height*.8,self.height*.8)

                                        Label:
                                            size_hint_y: .5
                                            
                                        GridLayout:
                                            rows: 1
                                            Image:
                                                id: fm
                                                idd: 'fm'
                                                size_hint_y: None
                                                height: self.parent.parent.height*.5
                                                source: 'src/fm.png'

                                            Image:
                                                id: date
                                                idd: 'date'
                                                size_hint_y: None
                                                height: self.parent.parent.height*.5
                                                source: 'src/date.png'

                                            Image:
                                                id: music_list
                                                idd: 'music_list'
                                                size_hint_y: None
                                                height: self.parent.parent.height*.5
                                                source: 'src/music_list.png'

                                            Image:
                                                id: top
                                                idd: 'top'
                                                size_hint_y: None
                                                height: self.parent.parent.height*.5
                                                source: 'src/top.png'

                                        
                                    FloatLayout:
                                        size_hint_y: None
                                        height: 5
                                        id: box_fm
                                        MiddleLabel:
                                            pos_hint: {'center_x':1/8, 'center_y': -2}
                                            id: l_fm
                                            text: '私人FM'

                                        MiddleLabel:
                                            pos_hint: {'center_x':1/8+1/4, 'center_y': -2}
                                            id: l_date
                                            text: '每日推荐'
                                            
                                        MiddleLabel:
                                            pos_hint: {'center_x':1/8+1/4*2, 'center_y': -2}
                                            id: l_ml
                                            text: '歌单'

                                        MiddleLabel:
                                            pos_hint: {'center_x':1/8+1/4*3, 'center_y': -2}
                                            id: l_top
                                            text: '排行榜'


                                    LeftLabel:
                                        text:''
                                        height:root.height*.07
                                        
                                    GridLayout:
                                        id: recommand_m_l
                                        cols: 3
                                        size_hint_y: None
                                        height: self.minimum_height

                                        LeftLabel:
                                            pos_hint: {'center_x':.5, 'center_y': .3}
                                            text: '推荐歌单 >'
                                            
                                        Label:

                                        Label:

                                        RecommendPlaylist:

                            ScrollView:
                                id: second_page_2_s
                                size_hint_x: None
                                width: root.width
                                do_scroll_x: False
                                
                                GridLayout:
                                    id: second_page_2
                                    cols: 1
                                    size_hint: None,None
                                    width: root.width
                                    height: self.minimum_height

                                    LeftLabel:
                                        text: '你哪来的朋友!'
                                        size_hint_y: None

                            ScrollView:
                                id: third_page_2_s
                                size_hint_x: None
                                width: root.width
                                do_scroll_x: False
                                
                                GridLayout:
                                    id: third_page_2
                                    cols: 1
                                    size_hint: None,None
                                    width: root.width
                                    height: self.minimum_height

                                    LeftLabel:
                                        text: '啥年代了听电台呢'

                    ScrollView:
                        id: third_page_s
                        size_hint_x: None
                        width: root.width
                        do_scroll_x: False
                        
                        GridLayout:
                            id: third_page_s_g
                            cols: 1
                            size_hint: None,None
                            width: root.width
                            height: self.minimum_height
                                
                            LeftLabel:
                                id: video_label
                                text: '看个锤锤视频'

                    
                 
                    FloatLayout:
                        id: sidebar
                        size_hint_x: None
                        width: 0
                        GridLayout:
                            id: sidebar_g
                            rows: 1
                            size_hint: None,None
                            raised: False
                            width: root.width
                            height: root.height
                            pos_hint: {}
                            pos: -self.width,0

                            GridLayout:
                                size_hint: 5,1
                                cols: 1
                                ScrollView:
                                    id: sidebar_s
                                    size_hint_y: 10
                                    on_scroll_start: None
                                    on_scroll_stop: None
                                    
                                    GridLayout:
                                        cols: 1
                                        size_hint_y: None
                                        height: self.minimum_height

                                        GridLayout:
                                            cols: 1
                                            size_hint_y: None
                                            height: root.height*.25
                                            canvas.before:
                                                Rectangle:
                                                    source: 'src/star_sky.png'
                                                    size: self.width,self.height
                                                    pos: self.pos
                                            
                                            GridLayout:
                                                cols: 1
                                                size_hint_y: 3

                                            GridLayout:
                                                id: avatar_image_0
                                                rows: 1
                                                size_hint_y: 2
                                                canvas.before:
                                                    Ellipse:
                                                        source: app.avatar_fn
                                                        size: self.height,self.height
                                                        pos: self.pos[0]+self.width*.015, self.pos[1]

                                            GridLayout:
                                                rows: 1

                                                Label:
                                                    size_hint_x: None
                                                    width: root.height*.03
                                                    
                                                Label:
                                                    id: avatar_text_0
                                                    color: C('#ffffff')
                                                    text: app.nickname
                                                    font_size: app.font_size
                                                    size_hint_x: None
                                                    width: self.texture_size[0]

                                                Label:
                                                    size_hint_x: None
                                                    width: root.height*.02
                                                    
                                                GridLayout:
                                                    rows: 1
                                                    size_hint_x: None
                                                    width: self.minimum_width
                                                    canvas:
                                                        Color:
                                                            rgb: white
                                                        Line:
                                                            width: 1.01
                                                            rounded_rectangle: (self.center[0]-app.font_size*1.5*.6,self.center[1]-app.font_size*.6*.6,app.font_size*3*.6,app.font_size*1.2*.6,app.font_size*.36,app.font_size*.36,app.font_size*.36,app.font_size*.36,30)

                                                        
                                                    Label:
                                                        color: C('#ffffff')
                                                        font_size: app.font_size*.6
                                                        size_hint_x: None
                                                        width: self.texture_size[0]
                                                        text: 'Lv.5'

                                                Label:
                                                    
                                                GridLayout:
                                                    idd: 'check_in'
                                                    on_touch_up: app.touch_on_layout(args)
                                                    size_hint_x: None
                                                    width: self.minimum_width
                                                    
                                                    rows: 1
                                                    canvas:
                                                        Color:
                                                            rgb: white
                                                        Line:
                                                            width: 1.01
                                                            rounded_rectangle: (self.center[0]-app.font_size*1.5,self.center[1]-app.font_size*.6,app.font_size*3,app.font_size*1.2,app.font_size*.6,app.font_size*.6,app.font_size*.6,app.font_size*.6,30)
                                                    Label:
                                                        color: C('#ffffff')
                                                        font_size: app.font_size
                                                        size_hint_x: None
                                                        width: self.texture_size[0]
                                                        text: '签到'
                                                        
                                                Label:
                                                    size_hint_x: None
                                                    width: root.height*.03

                                        GridLayout:
                                            cols: 1
                                            size_hint_y: None
                                            height: self.minimum_height

                                            SideBarBox:
                                                idd: 'message'
                                                i0: 'src/message.png'
                                                t0: '我的消息'

                                            SideBarBox:
                                                idd: 'vip'
                                                i0: 'src/vip.png'
                                                t0: '会员中心'

                                            SideBarBox:
                                                idd: 'ticket'
                                                i0: 'src/ticket.png'
                                                t0: '云村有票'

                                            SideBarBox:
                                                idd: 'shop'
                                                i0: 'src/shop.png'
                                                t0: '商城'
                                                
                                            GridLayout:
                                                size_hint_y:None
                                                height: root.height/50
                                                
                                                canvas.before:
                                                    Color:
                                                        rgb: dark_gray
                                                        
                                                    Rectangle:
                                                        pos: self.pos
                                                        size: self.size

                                            SideBarBox:
                                                idd: 'theme'
                                                i0: 'src/theme.png'
                                                t0: '个性换肤'

                                        LeftLabel:
                                            id: sidebar_left_label
                                            text: ''
                                            
                                WhiteGridLayout:
                                    rows: 1

                                    Label:
                                        size_hint_x: None
                                        width: min(root.width*.03,self.parent.width)
                                        
                                    GridLayout:
                                        idd: 'night'
                                        size_hint_x: None
                                        width: self.minimum_width
                                        on_touch_up: app.touch_on_layout(args)
                                        rows: 1
                                        Image:
                                            size_hint_x: None
                                            width: min(self.height,self.parent.parent.width)
                                            source: 'src/night.png'
                                            
                                        FixedHeightLeftLabel:
                                            text: '夜间模式'
                                            font_size: app.font_size if self.parent.parent.width else 0
                                            

                                    Label:
                                        
                                    GridLayout:
                                        idd: 'setting'
                                        size_hint_x: None
                                        width: self.minimum_width
                                        on_touch_up: app.touch_on_layout(args)
                                        rows: 1
                                        Image:
                                            size_hint_x: None
                                            width: min(self.height,self.parent.parent.width)
                                            source: 'src/setting.png'
                                            
                                        FixedHeightLeftLabel:
                                            text: '设置'
                                            font_size: app.font_size if self.parent.parent.width else 0

                                    Label:
                                        
                                    GridLayout:
                                        idd: 'exit'
                                        size_hint_x: None
                                        width: self.minimum_width
                                        on_touch_up: app.touch_on_layout(args)
                                        rows: 1
                                        Image:
                                            size_hint_x: None
                                            width: min(self.height,self.parent.parent.width)
                                            source: 'src/exit.png'
                                            
                                        FixedHeightLeftLabel:
                                            text: '退出'
                                            font_size: app.font_size if self.parent.parent.width else 0

                                    Label:
                                        size_hint_x: None
                                        width: min(root.width*.03,self.parent.width)
                                            
                            GridLayout:
                                id: shadow
                                cols: 1
                                opacity: .4
                                idd: 'menu'
                                on_touch_up:app.touch_on_layout(args)
                                
                                canvas.before:
                                    Color:
                                        rgb: black
                                    Rectangle:
                                        size: self.width,self.height
                                        pos: self.pos

            WhiteGridLayout:
                id: playbar
                cols: 1
                size_hint: 1,None
                height: 0

                Label:
                    size_hint_y: .1
                    
                GridLayout:
                    rows: 1
                    idd: 'song_detail'
                    on_touch_up: app.touch_on_layout(args)
                    Label:
                        size_hint_x: None
                        width: self.height*.1
                        
                    Image:
                        id: current_song_cover
                        size_hint_x: None
                        width: self.height
                        source: 'src/avatar.jpg'
                        

                    GridLayout:
                        cols: 1
                        size_hint_x: None
                        width: self.minimum_width

                        FixedHeightLeftLabel:
                            id: playbar_song_name
                            font_size: self.height*.6
                            size_hint_y: 2
                            text: ''

                        FixedHeightLeftLabel:
                            size_hint_y: 1
                            color: C(hex_light_black)
                            font_size: self.height*.9
                            text: '横划也切换不了上下首哦'

                    GridLayout:
                        rows: 1
                        size_hint_x: None
                        width: self.minimum_width
                        pos: self.parent.pos[0]+self.parent.width*.95-self.width,self.pos[1]
                        
                        Image:
                            id: playbar_status
                            idd: 'play_or_stop'
                            on_touch_up: app.touch_on_layout(args)
                            size_hint_x: None
                            width: self.height*.7
                            source: 'src/pausing.png'

                        Label:
                            size_hint_x: None
                            width: self.height*.7
                            
                        Image:
                            id: loop_stt
                            idd: 'change_loop_status'
                            on_touch_up: app.touch_on_layout(args)
                            size_hint_x: None
                            width: self.height*.4
                            source: 'src/play_list.png'
                        
                                
                Label:
                    size_hint_y: .1

    Screen:
        name: 'search'
        GridLayout:
            cols: 1
            RedGridLayout:
                rows: 1
                size_hint_y: None
                height: root.width*.1
                Image:
                    idd: 'back'
                    on_touch_up: app.touch_on_layout(args)
                    size_hint_x: None
                    height: self.width
                    source: 'src/white_arrow_left.png'

                GridLayout:
                    rows: 1
                    
                    TextInput:
                        id: search_bar
                        background_color: (0,0,0,0)
                        cursor_color: (1,1,1,1)
                        foreground_color: (1,1,1,1)
                        hint_text: 'G.E.M.邓紫棋'
                        hint_text_color: (1,1,1,.6)
                        

                    Image:
                        idd: 'search_music'
                        on_touch_up: app.touch_on_layout(args)
                        size_hint_x: None
                        height: self.width
                        source: 'src/search.png'
                        
            RedGridLayout:
                rows: 1
                size_hint_y: None
                height: root.height*.05
                Label:
                    font_size: app.font_size
                    text: '综合'

                Label:
                    font_size: app.font_size
                    text: '单曲'
                
                Label:
                    font_size: app.font_size
                    text: '视频'

                Label:
                    font_size: app.font_size
                    text: '歌手'

                Label:
                    font_size: app.font_size
                    text: '专辑'

            ScrollView:
                id: search_m_l_sv
                size_hint_y: 1
                GridLayout:
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height

                    GridLayout:
                        rows: 1
                        size_hint_y: None
                        height: root.height*.05
                        Label:
                            text: '单曲'
                            color: C('#000000')
                            font_size: app.font_size
                            size_hint_x: None
                            width: (len(self.text)+1)*self.font_size

                        GridLayout:
                            rows: 1
                            Image:
                                idd: 'play_all_search_songs'
                                on_touch_up: app.touch_on_layout(args)
                                source: 'src/pausing.png'
                                size_hint_x: None
                                width: self.height

                            FixedHeightLeftLabel:
                                text: '播放全部'
                                font_size: app.font_size

                            Label:

                            Label:
                                text: '查看更多>'
                                color: C(hex_light_black)
                                font_size: app.font_size*.7
                                size_hint_x: None
                                width: len(self.text)*self.font_size

                    GridLayout:
                        cols: 1
                        id: search_pl_g
                        size_hint_y: None
                        height: self.minimum_height
                        
                        


    Screen:
        name: 'login'
        GridLayout:
            cols: 1
            RedGridLayout:
                cols: 1
                size_hint_y: .3

            RedGridLayout:
                rows:1
                Label:
                    size_hint_x:1
                FixedHeightLeftLabel:
                    text: '请先登录'

                Label:
                    size_hint_x:5

            TextInput:
                id: t_i_un

            TextInput:
                id: t_i_pd
                password: True

            Button:
                id: b_login
                text: '登录'
                on_press: app.login_by_pd()

    Screen:
        current_pl_id: None
        name: 'music_list'
        GridLayout:
            cols: 1
            
            GridLayout:
                size_hint_y: None
                height: root.height*.3
                canvas.before:
                    Color:
                        rgb: dark_gray
                    Rectangle:
                        pos: self.pos
                        size: self.size
                    
                cols: 1
                GridLayout:
                    rows: 1
                    GridLayout:
                        rows: 1
                        Image:
                            idd: 'back'
                            on_touch_up: app.touch_on_layout(args)
                            
                            source: 'src/arrow_left.png'
                            
                        FixedHeightLeftLabel:
                            text: '歌单'

                    Label:
                        size_hint_x: 3

                    GridLayout:
                        rows: 1
                        Image:
                            source: 'src/search.png'

                        Image:
                            source: 'src/point.png'

                GridLayout:
                    rows: 1
                    size_hint_y: 2
                    Image:
                        id: big_pl_cover
                        source: 'src/avatar.jpg'

                    GridLayout:
                        cols: 1
                        
                        FixedHeightLeftLabel:
                            id: pl_name
                            text: '我喜欢的音乐'

                        GridLayout:
                            rows: 1
                            Image:
                                id: creator_avatar
                                size_hint_x: None
                                width: self.height
                                source: 'src/avatar.jpg'

                            FixedHeightLeftLabel:
                                id: creator_name
                                text: app.nickname

                    Label:
                            
                GridLayout:
                    rows: 1
                    Image:
                        source: 'src/comment.png'

                    Image:
                        source: 'src/share.png'

                    Image:
                        source: 'src/white_download.png'

                    Image:
                        source: 'src/muti_choice.png'
                
                        
            WhiteGridLayout:
                rows: 1
                size_hint_y: None
                height: root.height*.05

                Image:
                    size_hint_x: None
                    width: self.height
                    source: 'src/avatar.jpg'
                    
                FixedHeightLeftLabel:
                    text: '播放全部'

            ScrollView:
                id: m_l_sv
                GridLayout:
                    id: playlist_songs
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height
                    
                    SingleMusicGlayout:

    Screen:
        name: 'song_lyric'
        GridLayout:
            cols: 1
            canvas.before:
                Color:
                    rgb: dark_gray
                    
                Rectangle:
                    size: self.size
                    pos: self.pos

            GridLayout:
                rows: 1
                size_hint_y: None
                height: root.height*.1
                
                Image:
                    size_hint_x: None
                    width: self.height
                    source: 'src/arrow_left.png'

                GridLayout:
                    cols: 1
                    FixedHeightLeftLabel:
                        size_hint_y: 1.5
                        text: 'SongName'
                    FixedHeightLeftLabel:
                        text: 'AuthorName'

            ScrollView:
                GridLayout:
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height
                    Label:
                        id: lyric_label
                        size_hint_y: None
                        font_size: app.font_size
                        color: common+(.8,)
                        size_hint_y: None
                        height: self.texture_size[1]
                        
                        text: '正在加载...'

            GridLayout:
                rows: 1
                size_hint_y: None
                height: app.font_size*.6

                Label:
                    size_hint_x: None
                    width: root.width*.1
                    text: 'CurrentTime'

                GridLayout:
                    rows: 1
                    canvas.before:
                        Color:
                            rgb: white
                        Line:
                            points: [self.pos[0], self.pos[1]+self.height*.5, self.pos[0]+self.width, self.pos[1]+self.height*.5]
                        
                Label:
                    size_hint_x: None
                    width: root.width*.1
                    text: 'CurrentTime'

            GridLayout:
                rows: 1
                size_hint_y: None
                height: root.height*.15

                Label:
                    size_hint_x: None
                    width: root.width*.1
                Image:
                    size_hint_x: None
                    width: self.height*.5
                    source: 'src/avatar.jpg'
                        
                GridLayout:
                    rows: 1
                    Image:
                        size_hint_y: None
                        height: self.parent.height*.5
                        center_y: self.parent.center_y
                        source: 'src/avatar.jpg'
                    Image:
                        source: 'src/avatar.jpg'
                    Image:
                        size_hint_y: None
                        height: self.parent.height*.5
                        center_y: self.parent.center_y
                        source: 'src/avatar.jpg'

                Image:
                    size_hint_x: None
                    width: self.height*.5
                    source: 'src/avatar.jpg'
                Label:
                    size_hint_x: None
                    width: root.width*.1















